VIZWeb3D['Clipping']=function(a,b,c,d,e,f,g){var h=this,i=new VIZWeb3D['EventDispatcher'](window,container);this['EventHandler']=i;var j=e,k=f,l=null,m=0x0,n=d,o=![],p=![],q=g;this['Option']={get 'Visible'(){return s['visible'];},set 'Visible'(L){s['visible']=L,i['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}};var r={'type':'change'},s=null,t=[],u=[],v=null,w=null,x=new THREE['Plane'](new THREE['Vector3'](-0x1,0x0,0x0),0x0),y=new THREE['Plane'](new THREE['Vector3'](0x0,-0x1,0x0),0x0),z=new THREE['Plane'](new THREE['Vector3'](0x0,0x0,-0x1),0x0);globalPlane=new THREE['Plane'](new THREE['Vector3'](-0x1,0x0,0x0),0.1);var A=null,B=null,C=null;D();function D(){s=new THREE['Object3D'](),s['visible']=!![],a['add'](s),E();}function E(){n['addEventListener']('start',function(){H();}),n['addEventListener']('end',function(){F();}),transformControl=new THREE['TransformControls'](b,c['domElement']),transformControl['showX']=![],transformControl['showY']=![],transformControl['showZ']=![],transformControl['addEventListener']('change',function(L){h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),transformControl['addEventListener']('dragging-changed',function(L){n['enabled']=!L['value'],h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),a['add'](transformControl),transformControl['addEventListener']('change',function(){H(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),transformControl['addEventListener']('mouseDown',function(){m=t[0x0]['constant'],H(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),transformControl['addEventListener']('mouseUp',function(){F(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),transformControl['addEventListener']('objectChange',function(){I(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),dragcontrols=new THREE['DragControls'](u,b,c['domElement']),dragcontrols['enabled']=![],dragcontrols['addEventListener']('hoveron',function(L){transformControl['attach'](L['object']),H(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);}),dragcontrols['addEventListener']('hoveroff',function(){F(),h['EventHandler']['dispatchEvent'](EVENT_TYPES['Control']['Changed']);});}function F(){H(),G();}function G(){l=setTimeout(function(){transformControl['detach'](transformControl['object']);},0x9c4);}function H(){if(l)clearTimeout(l);}function I(){var L=new THREE['Vector3']();L['copy'](transformControl['pointEnd'])['sub'](transformControl['pointStart']);p&&(L['x']*=-0x1,L['y']*=-0x1,L['z']*=-0x1);if(w===CLIPPING_MODES['X'])t[0x0]['constant']=m+L['x'];else{if(w===CLIPPING_MODES['Y'])t[0x0]['constant']=m+L['y'];else{if(w===CLIPPING_MODES['Z'])t[0x0]['constant']=m+L['z'];}}}function J(L){for(var M=0x0;M<L['children']['length'];M++){if(L['children'][M]instanceof THREE['Mesh'])L['children'][M]['material']['clippingPlanes']=t,L['children'][M]['material']['clipShadows']=!![];else L['children'][M]instanceof THREE['LineSegments']?(L['children'][M]['material']['clippingPlanes']=t,L['children'][M]['material']['clipShadows']=!![]):J(L['children'][M]);}}function K(){q['Materials']['hiddenline_basic']['clippingPlanes']=t,q['Materials']['hiddenline_basic']['clipShadows']=!![];}this['UpdateModel']=function(L,M){j=L;let N=this['BoundingBox'](j);var O=new THREE['Vector3']((N['max']['x']+N['min']['x'])/0x2,(N['max']['y']+N['min']['y'])/0x2,(N['max']['z']+N['min']['z'])/0x2);M&&(x['constant']=O['x'],y['constant']=O['y'],z['constant']=O['z']),J(j),J(k),K();},this['BoundingBox']=function(L){var M=this;if(L instanceof THREE['Mesh']){if(L['visible']){var N=L['geometry'];return N['computeBoundingBox'](),N['boundingBox'];}}if(L instanceof THREE['Object3D']){var O=new THREE['Box3']();for(var P=0x0;P<L['children']['length'];P++){O['union'](M['BoundingBox'](L['children'][P]));}return O;}},this['Enable']=function(L,M){o=L;if(w===M)return;v!==null&&(transformControl['detach'](transformControl['object']),s['remove'](v),u['splice'](0x0,0x1),w=null,v=null);t=[];if(L){let W=this['BoundingBox'](j),X=W['getBoundingSphere'](),Y=X['center'];var N=W['max']['x']-W['min']['x'],O=W['max']['y']-W['min']['y'],P=W['max']['z']-W['min']['z'],Q=N*0.1,R=O*0.1,S=P*0.1;if(M===CLIPPING_MODES['X']){transformControl['showX']=!![],transformControl['showY']=![],transformControl['showZ']=![],t['push'](x);var T=new THREE['Mesh'](new THREE['PlaneBufferGeometry'](P+S,O+R),new THREE['MeshBasicMaterial']({'color':0xff0000,'transparent':!![],'opacity':0.05,'side':THREE['DoubleSide'],'depthWrite':![]}));T['rotation']['y']=Math['PI']/0x2;if(p)T['position']['set'](-x['constant'],Y['y'],Y['z']);else T['position']['set'](x['constant'],Y['y'],Y['z']);s['add'](T),u['push'](T),v=T,w=CLIPPING_MODES['X'],m=-j['position']['x'],s['visible']=!![];}else{if(M===CLIPPING_MODES['Y']){transformControl['showX']=![],transformControl['showY']=!![],transformControl['showZ']=![],t['push'](y);var U=new THREE['Mesh'](new THREE['PlaneBufferGeometry'](N+Q,P+S),new THREE['MeshBasicMaterial']({'color':0xff00,'transparent':!![],'opacity':0.05,'side':THREE['DoubleSide'],'depthWrite':![]}));U['rotation']['x']=Math['PI']/0x2;if(p)U['position']['set'](Y['x'],-y['constant'],Y['z']);else U['position']['set'](Y['x'],y['constant'],Y['z']);s['add'](U),u['push'](U),v=U,w=CLIPPING_MODES['Y'],m=-j['position']['y'],s['visible']=!![];}else{transformControl['showX']=![],transformControl['showY']=![],transformControl['showZ']=!![],t['push'](z);var V=new THREE['Mesh'](new THREE['PlaneBufferGeometry'](N+Q,O+R),new THREE['MeshBasicMaterial']({'color':0xff,'transparent':!![],'opacity':0.05,'side':THREE['DoubleSide'],'depthWrite':![]}));if(p)V['position']['set'](Y['x'],Y['y'],-z['constant']);else V['position']['set'](Y['x'],Y['y'],z['constant']);s['add'](V),u['push'](V),v=V,w=CLIPPING_MODES['Z'],m=-j['position']['z'],s['visible']=!![];}}}J(j),J(k),K(),i['dispatchEvent'](EVENT_TYPES['Control']['Changed']);},this['Inverse']=function(){if(v!==null){p=!p,x['normal']['x']=-x['normal']['x'],x['constant']=-x['constant'],y['normal']['y']=-y['normal']['y'],y['constant']=-y['constant'],z['normal']['z']=-z['normal']['z'],z['constant']=-z['constant'];if(w===CLIPPING_MODES['X'])m=x['constant'];else{if(w===CLIPPING_MODES['Y'])m=y['constant'];else m=z['constant'];}}i['dispatchEvent'](EVENT_TYPES['Control']['Changed']);},this['GetClipInfo']=function(){var L={'enable':v,'type':w,'inverse':p,'value':t['length']===0x0?0x0:t[0x0]['constant']};return L;};};